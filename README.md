# Isaac & Corine Wedding Website

Wedding website for Isaac & Corine — June 20, 2026.
Live at **https://isaacandcorine.com/**

## Tech Stack

| Layer | Technology |
|-------|-----------|
| Frontend | HTML, CSS, vanilla JS |
| Backend | PHP 8.x on Namecheap shared hosting |
| Database | MongoDB Atlas (via REST Data API) |
| Email | PHPMailer 7.0.2 over SMTP |
| Deploy | GitHub Actions → rsync over SSH |

## Project Structure

```
├── index.html              # Main single-page website
├── discover.html            # Standalone Discover Lebanon page (legacy)
├── style.css                # All styles (~1600 lines)
├── script.js                # All interactivity (~720 lines)
├── .htaccess                # HTTPS, security headers, caching
│
├── assets/
│   ├── intro-letter.mp4     # Envelope opening video
│   ├── hero-birds.mp4       # Hero background video
│   ├── song.m4a             # Background music
│   ├── ball-dance.webp      # Schedule & footer image
│   ├── confetti-CrGrT4ka.gif
│   ├── flowers/             # Decorative watercolor flowers
│   ├── butterflies/         # Decorative butterflies
│   └── destinations/        # Discover Lebanon images
│
├── api/
│   ├── config.example.php   # Configuration template (committed)
│   ├── config.php           # Actual config with secrets (GITIGNORED)
│   ├── MongoAtlas.php       # MongoDB Atlas Data API helper class
│   ├── guest-lookup.php     # Guest name lookup endpoint
│   ├── token.php            # CSRF token generator (GITIGNORED)
│   ├── token.example.php    # Token generator template (committed)
│   ├── send-rsvp.php        # RSVP submission handler (GITIGNORED)
│   ├── send-rsvp.example.php# RSVP handler template (committed)
│   ├── .htaccess            # API-level security rules
│   ├── rate_limits/         # Auto-created rate limit data (GITIGNORED)
│   └── PHPMailer-7.0.2/     # PHPMailer library (GITIGNORED)
│
└── .github/workflows/
    └── deploy.yml           # Production deploy (main → Namecheap)
```

## Sections

1. **Intro Overlay** — Full-screen envelope video, tap to open (starts music)
2. **Hero** — Looping birds video with "Isaac & Corine" and date
3. **Invitation** — Formal wedding invitation from both families
4. **Countdown** — Live countdown with canvas fireworks when it reaches zero
5. **Location** — Two venue cards with embedded Google Maps
6. **Schedule** — Timeline from 5:30 PM walk to 1:00 AM after party
7. **Travel & Stay** — Hotels, restaurants (accordion categories), tips
8. **Discover Lebanon** — Mosaic of 11 destinations (in-page toggle)
9. **Gifts** — Wedding registry with reveal button
10. **RSVP** — Guest lookup by name → shows invitation card with +1 → confirm

## MongoDB Database Structure

### Multi-Tenant Design

The database uses a **tenant model** where each wedding website has its own `tenant_id`. All documents in shared collections include this field, so multiple wedding sites can share the same database.

### Database: `wedding_websites`

### Collection: `guests`

| Field | Type | Description |
|-------|------|-------------|
| `_id` | ObjectId | Auto-generated by MongoDB |
| `tenant_id` | string | Website identifier (e.g., `"isaac-and-corine"`) |
| `name` | string | Guest's full name (display version) |
| `name_lower` | string | Lowercase version of name (used for lookup) |
| `plus_one` | boolean | Whether the guest has a +1 |
| `plus_one_name` | string\|null | Name of the +1 guest |
| `rsvp_status` | string | `"pending"`, `"attending"`, or `"declined"` |
| `rsvp_date` | string\|null | ISO date when RSVP was submitted |
| `created_at` | string | ISO date when record was created |
| `updated_at` | string | ISO date when record was last updated |

### Example Document

```json
{
  "_id": { "$oid": "65a1b2c3d4e5f6a7b8c9d0e1" },
  "tenant_id": "isaac-and-corine",
  "name": "John Smith",
  "name_lower": "john smith",
  "plus_one": true,
  "plus_one_name": "Jane Smith",
  "rsvp_status": "pending",
  "rsvp_date": null,
  "created_at": "2026-02-16T12:00:00+00:00",
  "updated_at": "2026-02-16T12:00:00+00:00"
}
```

### Recommended Indexes

Create these in MongoDB Atlas UI (Database → Collections → Indexes):

```
{ "tenant_id": 1, "name_lower": 1 }   — for guest lookups
{ "tenant_id": 1, "rsvp_status": 1 }  — for filtering by status
```

### Adding Guests

You can add guests through MongoDB Atlas UI, or use the `mongosh` shell:

```javascript
db.guests.insertMany([
  {
    tenant_id: "isaac-and-corine",
    name: "John Smith",
    name_lower: "john smith",
    plus_one: true,
    plus_one_name: "Jane Smith",
    rsvp_status: "pending",
    rsvp_date: null,
    created_at: new Date().toISOString(),
    updated_at: new Date().toISOString()
  },
  {
    tenant_id: "isaac-and-corine",
    name: "Marie Dupont",
    name_lower: "marie dupont",
    plus_one: false,
    plus_one_name: null,
    rsvp_status: "pending",
    rsvp_date: null,
    created_at: new Date().toISOString(),
    updated_at: new Date().toISOString()
  }
]);
```

### For Future Wedding Websites

To add a new wedding site, simply use a different `tenant_id`:

```javascript
db.guests.insertOne({
  tenant_id: "another-wedding",   // ← different tenant
  name: "Guest Name",
  name_lower: "guest name",
  plus_one: false,
  plus_one_name: null,
  rsvp_status: "pending",
  rsvp_date: null,
  created_at: new Date().toISOString(),
  updated_at: new Date().toISOString()
});
```

All the API code filters by `tenant_id` automatically — no cross-site data leaks.

## Setup Guide

### 1. MongoDB Atlas

1. Create a free account at [cloud.mongodb.com](https://cloud.mongodb.com)
2. Create a cluster (free tier M0 is fine)
3. Create a database called `wedding_websites`
4. Create a collection called `guests`
5. Enable the **Data API**:
   - Go to **App Services** (top nav)
   - Click your app (or create one)
   - Go to **HTTPS Endpoints** or **Data API** → Enable
6. Create an **API Key**:
   - Go to **Authentication** → **API Keys**
   - Create a key and save it securely
7. Note your **App ID** from the URL (e.g., `data-abcde`)
8. Add indexes as recommended above
9. Insert your guest list (see "Adding Guests" above)

### 2. Server Setup (Namecheap)

1. Copy `api/config.example.php` → `api/config.php`
2. Fill in your MongoDB Atlas Data API URL, API key, and cluster name
3. Fill in your SMTP credentials
4. Set a strong random string for `token_secret` (64+ characters)
5. Copy `api/token.example.php` → `api/token.php`
6. Copy `api/send-rsvp.example.php` → `api/send-rsvp.php`
7. Download [PHPMailer 7.0.2](https://github.com/PHPMailer/PHPMailer/releases/tag/v7.0.2) and extract to `api/PHPMailer-7.0.2/`
8. Set directory permissions:
   ```bash
   chmod 700 api/rate_limits/
   chmod 600 api/config.php
   ```

### 3. GitHub Secrets (for deployment)

Set these in **Settings → Secrets and variables → Actions**:

| Secret | Description |
|--------|-------------|
| `SSH_PRIVATE_KEY` | SSH private key for Namecheap |
| `SSH_HOST` | Server hostname |
| `SSH_USER` | SSH username |
| `DEPLOY_PATH` | Remote path (e.g., `/home/user/public_html/`) |

### 4. Deploy

Push to `main` to deploy to production.

## Security

- **CSRF tokens**: Signed HMAC tokens with 10-minute TTL
- **Rate limiting**: File-based, per-IP (10 req/min for lookups, 5 req/min for RSVP)
- **Input sanitization**: All user inputs stripped/validated before use
- **HTTPS enforced** via `.htaccess`
- **Security headers**: `X-Content-Type-Options`, `X-Frame-Options`, `Referrer-Policy`, `HSTS`
- **API protection**: `.htaccess` blocks direct access to config, libraries, and data files
- **No secrets in code**: All credentials live in `config.php` (gitignored)
- **PHP errors**: Logged to server, never displayed to users

## Background Texture

The site uses an SVG `feTurbulence` fractal noise filter to create a subtle **painted plaster/concrete wall texture** across the entire page. This gives the background an organic, slightly rough surface feel — like real paint on a concrete or stucco wall — rather than a flat digital color.

- Applied globally via `body::before` (covers all sections)
- Separately applied to `#main-nav::after` and `.section-footer::after` to ensure coverage on elements with their own stacking contexts
- Uses `pointer-events: none` so it never blocks interaction
- Tunable via `opacity` (currently `0.45`) and `baseFrequency` for grain coarseness

## Color Palette

| Color | Hex | Usage |
|-------|-----|-------|
| Cream | `#efdfd5` | Background |
| Dark Sage | `#587042` | Primary text, headings, buttons |
| Sage | `#a9b494` | Accents, borders, muted text |

## Fonts

- **Cormorant Garamond** — Display headings
- **Great Vibes** — Script/cursive (couple names)
- **Lora** — Body text
